---
title: "Why Elect When You Can Appoint?"
author: "Owen Phillips"
output: 
  html_document:
    fig_width: 8
    fig_height: 5
---
<div class="centered">
#Interactive Map
</div>

<!DOCTYPE html>
<html>
<head>
<meta name="viewport"></meta>
<title>Appointed vs Elected Superintendents.shp - Google Fusion Tables</title>
<style type="text/css">
html, body, #googft-mapCanvas {
  height: 300px;
  margin: 0;
  padding: 0;
  width: 500px;
}
</style>

<script type="text/javascript" src="https://maps.google.com/maps/api/js?sensor=false&amp;v=3"></script>

<script type="text/javascript">
  function initialize() {
    google.maps.visualRefresh = true;
    var isMobile = (navigator.userAgent.toLowerCase().indexOf('android') > -1) ||
      (navigator.userAgent.match(/(iPod|iPhone|iPad|BlackBerry|Windows Phone|iemobile)/));
    if (isMobile) {
      var viewport = document.querySelector("meta[name=viewport]");
      viewport.setAttribute('content', 'initial-scale=1.0, user-scalable=no');
    }
    var mapDiv = document.getElementById('googft-mapCanvas');
    mapDiv.style.width = isMobile ? '100%' : '500px';
    mapDiv.style.height = isMobile ? '100%' : '300px';
    var map = new google.maps.Map(mapDiv, {
      center: new google.maps.LatLng(32.701036216558855, -88.09666434375004),
      zoom: 6,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    });
    map.controls[google.maps.ControlPosition.LEFT_BOTTOM].push(document.getElementById('googft-legend-open'));
    map.controls[google.maps.ControlPosition.LEFT_BOTTOM].push(document.getElementById('googft-legend'));

    layer = new google.maps.FusionTablesLayer({
      map: map,
      heatmap: { enabled: false },
      query: {
        select: "col0",
        from: "1dIFW9UPwZDq3nr79brLQBE0B-mwhapX8TIo7tu0",
        where: ""
      },
      options: {
        styleId: 4,
        templateId: 2
      }
    });

    if (isMobile) {
      var legend = document.getElementById('googft-legend');
      var legendOpenButton = document.getElementById('googft-legend-open');
      var legendCloseButton = document.getElementById('googft-legend-close');
      legend.style.display = 'none';
      legendOpenButton.style.display = 'block';
      legendCloseButton.style.display = 'block';
      legendOpenButton.onclick = function() {
        legend.style.display = 'block';
        legendOpenButton.style.display = 'none';
      }
      legendCloseButton.onclick = function() {
        legend.style.display = 'none';
        legendOpenButton.style.display = 'block';
      }
    }
  }

  google.maps.event.addDomListener(window, 'load', initialize);
</script>
</head>

<body>
  <div id="googft-mapCanvas"></div>
</body>
</html>

<div class="centered">
##### 63 of Mississippi's 151 District Superintendents Are Elected 
</div>

```{r, echo=FALSE, results='asis', warning=FALSE, error=FALSE, message=FALSE, cache=FALSE}
library(devtools)
SourceURL <- ("https://raw.githubusercontent.com/Henryjean/Assignment3/master/DataAnalysis.R")
source_url(SourceURL)
```

## Test Score Distributions {.flexbox .vcenter}
```{r, results='asis', echo=FALSE, warning=FALSE, fig.align='center'}
way <- ggplot(submelted, aes(value, color = factor(AorE)))
way + geom_density(aes(fill = factor(AorE)), alpha = .55) + facet_wrap(~ variable) + 
ggtitle("SATP Test Score Distributions") + scale_fill_manual(values = c("#009966", "#D1322D")) + theme(legend.title=element_blank()) + scale_color_manual(values = c("#009966", "#D1322D"))
```

## Graduation Rate Distributions {.flexbox .vcenter}
```{r, results='asis', echo=FALSE, warning=FALSE, fig.align='center'}
gradrate <- ggplot(completeclean, aes(x = GradRate))
gradrate + geom_density(aes(fill=factor(AorE)), alpha =.75) +
ggtitle("Graduation Rates Distribution") + scale_fill_manual(values = c("#009966", "#D1322D")) + theme(legend.title=element_blank())
```

## Poverty Rate Distributions {.flexbox .vcenter}
```{r, results='asis', echo=FALSE, warning=FALSE, fig.align='center'}
poverty <- ggplot(completeclean, aes(x = PovertyPct))
poverty + geom_density(aes(fill=factor(AorE)), alpha = .75) + scale_fill_manual(values = c("#009966", "#D1322D")) + theme(legend.title=element_blank()) + ggtitle("Poverty Rates Distribution")
```


## Enrollment Size Distributions {.flexbox .vcenter}
```{r, results='asis', echo=FALSE, warning=FALSE, fig.align='center'}
EnrollmentDis <- ggplot(completeclean, aes(x = Enrolled100s))
EnrollmentDis + geom_density(aes(fill=factor(AorE)), alpha =.65) +
ggtitle("Enrollment Size Distribution") + scale_fill_manual(values = c("#009966", "#D1322D")) + theme(legend.title=element_blank())
```

## Regression Output {.flexbox .vcenter}

```{r, results='asis', echo=FALSE, warning=FALSE}

library(stargazer)
stargazer(newgradfit2, type ='html', covariate.labels=c("Elected Superintendent", "Pct Students in Poverty", "Student-to-Teacher Ratio", "Enrollment", "Elected:Enrollment"))
summary(newgradfit2)

```

## Modeling Graduation Rates 

```{r, results='asis', echo=FALSE, warning=FALSE}

stargazer(one, two, three, four, five, type = 'html', table.layout = "#tn", covariate.labels=c("Elected Superintendent", "Pct Students in Poverty",  "Student-to-Teacher Ratio", "Enrollment", "Elected:Enrollment"), column.labels = "Graduation Rates")


```

```{r, results='asis', echo=FALSE, cache=TRUE}
par(mfrow=c(1,2))
plot(simZ1)
title("Predicted Values for \nAppointed Districts")
plot(simZ2, xlim=c(1,60), ylim = c(60,80))
title("Predicted Values for \nElected Districts")

```
